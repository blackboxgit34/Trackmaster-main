@{
    ViewBag.Title = "Generate Routes";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="~/Content/Alertify/sweetalert.min.js"></script>
<link href="~/Content/Alertify/sweetalert.css" rel="stylesheet" />
<style>
    .nav {
        margin-left: 0;
        margin-bottom: 4px !important;
    }

    .select2-container {
        z-index: 1000 !important;
    }

    #directions-panel {
        color: #315492;
        height: 174px;
    }
    .ui-resizable{
        z-index:9999 !important;
    }

      .ui-front {
        z-index:9999 !important;
    }
   
</style>


<div id="Fade" class="w3-container city w3-animate-zoom">
    @*<form onclick="fg()">*@
        <div class="row-fluid">

            <div class="row-fluid">

                <div class="widget-body" style="border: 0">
                    <div class="row-fluid">
                        <div class="widget span12">
                            <div class="widget-header">
                                <i class="fa fa-truck"></i>
                                <h5>Generate Routes</h5>
                                <div class="pull-right" style="width: 200px;">
                                    <a href="/settings/ManageRoute" target="_blank">    <button class="pull-right btn btn-green btn-small" style="margin-top: 5.5%; margin-right: 10%;" href="#">View Routes </button></a>             <a href="/admin/statusreport" target="_blank">    <button class="pull-right btn btn-green btn-small" style="margin-top: -13.5%;margin-right: 62%;" href="#">Live Tracking </button></a>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>



                <div class="col-md-12" style="padding: 0px;">
                    <div class="row-fluid">
                        <div class="widget-body" style="border: 0">
                            <div class="row-fluid">
                                <div class="tab-pane active" id="1">
                                    <div class="widget span12">
                                        <div class="widget-body  " style="background: #fff; overflow-x: auto">
                                            <div class="row">
                                              
                                                <div class="col-md-5">


                                                    <div id="DivVehcleCounter">
                                                        <div class="box-content padded">
                                                            <form data-toggle="validator" role="form">

                                                                <div class="row">
                                                                    <div class="col-md-1">
                                                                    </div>

                                                                    <div class="col-md-9">

                                                                        <div class="form-group ">
                                                                            <span>
                                                                                <label for="inputName" class="control-label" style="color:#2d4dbf;font-weight:bold">Route Name</label>
                                                                            </span>

                                                                            <span style="color: indianred" class="hidden" id="valRouteName"><i class=" fa fa-exclamation-triangle"></i>Please enter Route Name.</span>

                                                                            <input type="text" class="pull-right" id="txtRouteName" placeholder="Enter route name" />
                                                                        </div>

                                                                        <div class="form-group" style="display: none;">
                                                                            <label for="inputName" class="control-label"><b>Route Type</b></label>
                                                                            <select id="triptype">
                                                                                <option value="1">Single Route</option>
                                                                                <option value="2">Round Route</option>
                                                                            </select>
                                                                        </div>
                                                                    </div>

                                                                    <div class="col-md-2">
                                                                        <button type="button" class="btn btn-default btn-small pull-right" id="btntrip" style="display: none;">Route Details<img src="~/img/flags/3723_-_Route_II-512%20(1).png" style="height: 16px" /></button>
                                                                    </div>
                                                                    <div style="display: none;">
                                                                        <label for="exampleInputEmail1">Radius</label>
                                                                        <div class="input-group" style="margin-bottom: 10px;">
                                                                            <input type="number" class="form-control" id="Kilo" placeholder="Enter Km(s)" value="2000">
                                                                            <div class="input-group-addon ">KM</div>
                                                                        </div>
                                                                        <div class="input-group" style="margin-bottom: 10px;display:none;">
                                                                            <input type="text" class="form-control " id="Mtr" placeholder="Enter meters" value="0">
                                                                            <div class="input-group-addon ">M</div>
                                                                        </div>
                                                                    </div>



                                                                </div>
                                                                <div class="row">

                                                                    <div class="col-md-1">
                                                                    </div>
                                                                   
                                                                    <div class="col-md-8">

                                                                        <div class="form-group ">

                                                                            <span>
                                                                                <label for="inputName" class="control-label" style="color:#2d4dbf;font-weight:bold">Choose Start Point(POI)</label>
                                                                            </span>
                                                                            <select class="form-control select2" id="ddlStartLocationPOI" style="height: 70%;"></select>
                                                                        </div>
                                                                    </div>

                                                                    <div class="col-md-3">

                                                                        <div class="form-group">
                                                                            <span>
                                                                                <label for="inputName" class="control-label" style="color:#2d4dbf;font-weight:bold"><b>&nbsp;</b></label>
                                                                            </span>

                                                                            <input type="text" class="form-control" id="addressPlace" placeholder="Add start point  here..." style="position: relative; z-index: 100;margin-left: -29px;height: 28px;width: 188px;">

                                                                        </div>
                                                                    </div>

                                                                </div>
                                                                <div class="row" style="display:none;">

                                                                    <div class="col-md-1">
                                                                        &nbsp;
                                                                    </div>
                                                                    <div class="col-md-3">
                                                                        <div class="a">Moving&nbsp;<b><span id="movingtag" style="color:#2d4dbf;font-size:15px"></span></b></div>
                                                                    </div>
                                                                    <div class="col-md-2">
                                                                        <div class="b">Parked&nbsp;<b><span id="parkedtag" style="color:#2d4dbf;font-size:15px"></span></b></div>
                                                                    </div>
                                                                    <div class="col-md-2">
                                                                        <div class="c">IgnitionOn&nbsp;<b><span id="Ignitiontag" title="Ignition" style="color:#2d4dbf;font-size:15px"></span></b></div>
                                                                    </div>
                                                                    <div class="col-md-2">
                                                                        <div class="d">Hispeed&nbsp;<b><span id="Hispeedtag" title="Hispeed" style="color:#2d4dbf;font-size:15px"></span></b></div>
                                                                    </div>
                                                                    <div class="col-md-2">
                                                                        <div class="e">Unreachable&nbsp;<b><span id="Unreachtag" style="color:#2d4dbf;font-size:15px"></span></b></div>
                                                                    </div>


                                                                </div>
                                                                <br />


                                                                <div class="row">

                                                                    <div class="col-md-1">

                                                                    </div>


                                                                    <div class="col-md-11">
                                                                        <div class="form-group ">
                                                                            <span>
                                                                                <label for="inputName" class="control-label" style="color:#2d4dbf;font-weight:bold">Select Vehicle</label>
                                                                            </span>
                                                                            <select class="form-control select2" id="ddlVehicleList" multiple></select>
                                                                        </div>
                                                                    </div>

                                                                    <div style="display: none;">
                                                                        <span>
                                                                            <label for="inputName" class="control-label">Disable Radius Check</label>
                                                                        </span>
                                                                        <input type="checkbox" id="chkdisable" checked />
                                                                    </div>


                                                                </div>

                                                                <div class="row">
                                                                    <div class="col-md-1">
                                                                    </div>
                                                                    
                                                                    <div class="col-md-8">

                                                                        <div class="form-group">
                                                                            <span>
                                                                                <label for="inputName" class="control-label" style="color:#2d4dbf;font-weight:bold"><b>Choose End Point(POI)</b></label>
                                                                            </span>
                                                                            <select class="form-control select2" id="ddlEndLocationPOI" style="height: 70%;"></select>

                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="col-md-3">

                                                                        <div class="form-group">
                                                                            <span>
                                                                                <label for="inputName" class="control-label" style="color:#2d4dbf;font-weight:bold"><b>&nbsp;</b></label>
                                                                            </span>
                                                                          
                                                                            <input type="text" class="form-control" id="addressPlace1" placeholder="Add End Point  here..." style="position: relative; z-index: 100;margin-left: -29px;height: 28px;width: 188px;">

                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-1">
                                                                    </div>
                                                                    <div class="col-md-1">

                                                                    </div>




                                                                </div>

                                                                <div class="row">
                                                                    <div class="col-md-1">
                                                                    </div>
                                                                  
                                                                    <div class="col-md-8">
                                                                        <div class="form-group ">
                                                                            <span>
                                                                                <label for="inputName" class="control-label" id="hidediv" style="display: block;color:#2d4dbf;font-weight:bold">Add More Points(POI)</label>
                                                                            </span>

                                                                            <div id="hidediv2" style="display: block;">
                                                                                <select style="position: relative; z-index: 100;" class="form-control select2" id="ddlMoreLocationsPOI" multiple></select>
                                                                            </div>

                                                                        </div>

                                                                    </div>

                                                                    
                                                                    <div class="col-md-3">
                                                                        <div class="form-group">
                                                                            <span>
                                                                                <label for="inputName" class="control-label" id="hidediv" style="display: block;color:#2d4dbf;font-weight:bold">&nbsp;</label>
                                                                            </span>
                                                                            <div >
                                                                                <input type="text" class="form-control" id="addressPlace2" placeholder="Add more points Here ..." style="position: relative; z-index: 100;margin-left: -29px;height: 48px;width: 188px;">
                                                                         

                                                                                </div>
                                                                            </div>
                                                                    </div>


                                                                </div>

                                                                <div class="row">
                                                                    <div class="col-md-1">
                                                                    </div>
                                                                   
                                                                    <div class="col-md-11">
                                                                        <div class="form-group ">
                                                                            <span>
                                                                                <label for="inputName" class="control-label" style="display: block;color:#2d4dbf;font-weight:bold">Select Destination Arrival Time()</label>
                                                                            </span>
                                                                            <div>
                                                                                <input type="datetime-local" id="txtlocaltime" class="form-control" placeholder="Enter Time  Here ..." style="height: 70%;">

                                                                               
                                                                            </div>

                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-1">
                                                                    </div>

                                                                    <div class="col-md-8">
                                                                        <div class="form-group ">
                                                                            <span>
                                                                                <label for="inputName" class="control-label" style="display: block;color:#2d4dbf;font-weight:bold">Select date&time(optional)</label>
                                                                            </span>
                                                                            <div id="calendar" class="pull-right" style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc; width: 100%">
                                                                                <i class=" fa fa-calendar"></i>
                                                                                &nbsp;<span></span><b class="caret"></b>
                                                                            </div>

                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <br />
                                                                <div class="row">

                                                                    <div class="col-md-3">

                                                                    </div>

                                                                    <div class="col-md-2">
                                                                        <button type="button" onclick="submitUpdateSettings();" class="btn btn-success ">
                                                                            Submit
                                                                            <img src="~/img/flags/submit.png" style="height: 11px;" />
                                                                        </button>

                                                                    </div>

                                                                    <div class="=col-md-4" style="display:none;">
                                                                        <button class="btn btn-success btn-small " id="btnaddpoi">
                                                                            Add POI
                                                                            <img src="../img/flags/icon-png.png" style="height: 16px;" />
                                                                        </button>

                                                                    </div>
                                                                </div>


                                                            </form>
                                                        </div>
                                                    </div>


                                                </div>
                                      
                                               
                                                <div class="col-md-7" style="padding: 0px;">
                                                    <div class="box_a">
                                                        <div class="box_a_content">
                                                            <div id="map_canvas" style="width: 100%; height: 738px !important; position: inherit;"></div>
                                                            <div id="dvDistance">
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>


                                        </div>
                                    </div>



                                </div>
                            </div>

                        </div>
                    </div>

                </div>
            </div>
        </div>


        <div class="col-md-12" style="padding: 0px;">
            <div class="widget span12" style="position: absolute;
    top: 0px;
    z-index: 99;
    margin-left: 2px;
    margin-top: -574px;
    right: -863px;">
                <div class="widget-body  " style="background: #fff; overflow-x: auto; height: 541px; width: 301px; display: none" id="hidedivnew">
                    <div id="DivVehcledetails">
                        <div class="box-content padded">
                            <form data-toggle="validator" role="form">

                                <ul class="nav nav-tabs">
                                    <li class="active">

                                        <a href="#1" data-toggle="tab" style="background-color: #bababa; height: 48px; width: 429px; top: -15px; left: -118px; padding-top: 7px;">
                                            <span style="color: white; margin-left: 156px;">Route Details</span>
                                            <img id="imgclose" src="../images/battery/delete.png" style="height: 11px; width: 11px; margin-left: -133px; margin-top: -10px;" />
                                        </a>

                                    </li>
                                    <span>
                                        <label for="inputName" class="control-label"><b>Route Distance and Type</b></label>
                                    </span>
                                </ul>
                                <div class="col-md-12">
                                    <div class="col-md-6">
                                        <label for="inputName" class="control-label DatePicker"><b>Time</b></label>
                                        <span style="color: indianred" class="hidden" id="valTimeRange"><i class=" fa fa-exclamation-triangle"></i>Select Date range.</span>
                                        <div class="input-group">
                                            <div class="input-group date" data-provide="datepicker">
                                                <input type="text" id="txtETT" style="text-align: center; font-weight: bold;width:48px;" class="form-control " />
                                                <div class="input-group-addon">
                                                    <span class="">Minutes</span>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div class="col-md-6" style="background-color: transparent !important;">
                                        <div class="form-group ">
                                            <label for="inputName" class="control-label"><b>Distance</b></label>
                                            <div class="input-group">
                                                <div class="input-group date" data-provide="datepicker">
                                                    <input id="txtManualDistance" type="number" style="text-align: center; font-weight: bold;" class="form-control ">
                                                    <div class="input-group-addon">
                                                        <span class="">KM</span>
                                                    </div>
                                                </div>
                                                <input type="hidden" id="custId" name="custId" />
                                                <input type="hidden" id="bbid" name="bbid" />
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <ul class="nav nav-tabs">
                                    <li class="active"></li>
                                    <span>
                                        <label for="inputName" class="control-label"><b>Driving Time</b></label>
                                    </span>
                                </ul>
                                <img src="../img/flags/routecar.png" /><h4>
                                    <p id="test1" style="color: #315492; margin-left: 50PX; MARGIN-TOP: -35px;">This is a paragraph.</p>
                                </h4>
                                <div id="directions-panel" style="display: none;"></div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>


            <div class="widget span12" style="position: absolute;     left:609px;
    top: -522px; z-index: 99;">

                <div class="widget-body  " style="background: #f5f5f5; overflow-x: auto; height: 180px; width: 301px; display: none;" id="hidedivnewd">
                    <div id="Divpoidetails">
                        <div class="box-content padded">
                            <form data-toggle="validator" role="form">

                                <ul class="nav nav-tabs">
                                    <span>
                                        <label for="inputName" class="control-label"><b>Add POI </b></label>
                                    </span>
                                </ul>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <input type="text" class="form-control" id="addressPlace3" placeholder="Search location..." style="margin-left: 20px;"><img src="../img/flags/icon-png.png" style="height: 38px; margin-left: -26px; margin-top: -71px;" />
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <button type="button" onclick="Close();" class="btn btn-default pull-right" style="margin: -6%; background-color: #cccccc;">Close</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    



    @*</form>*@
            </div>
        


@*https://www.google.com/maps/dir/33.93729,-106.85761/33.91629,-106.866761/33.98729,-106.85861*@



<div id="PasswordDialog" title="Basic dialog" >

</div>
@section scripts{
    <script src="~/Scripts/app/common.js"></script>
    <script src="~/Content/js/APIURL.js"></script>
<script>
    $(function () {

        
        $('#calendar').daterangepicker({
            singleDatePicker: true,
            timePicker: true,    
        }, function (start, end, label) {
            debugger;
            $('#calendar span').html(start.format('MMM D YYYY, h:mm:ss a'));
           
        });
    });
</script>
    <script>
        $(document).ready(function () {
            $(".select2").select2({
                placeholder: "select an Options.",

            });

            ajaxForPopUp();
            appendVehicleDDL();  
          
        });

        function appendVehicleDDL() {

            $.ajax({
                dataType: "json",
                type: "GET",
                contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                url: apiBase.apiurl + "AdminAPI/GetVehicles",

                data: { custId: $custid },
                success: function (result) {

                    var data = result;

                    if (data.length > 0) {
                        $('#ddlVehicleList').append($('<option></option>').val(0).html("All Vehicle's"));
                        $.each(data, function (j, item) {
                            $('#ddlVehicleList').append($('<option></option>').val(item.Value).html(item.Text));

                        });
                    }

                }
            });
        }
        function ajaxForPopUp() {
            $('#ddlStartLocationPOI').html('');
            $('#ddlEndLocationPOI').html('');
            $('#ddlMoreLocationsPOI').html('');
            $.ajax({
                url: apiBase.apiurl + 'CommonApi/GetPOI?custid=' + $custid,
                type: "get",
                async: false,
                success: function (data) {
                    var result = data;
                    if (result.length > 0) {
                        $('#ddlStartLocationPOI').append($('<option disabled selected></option>').val("").html("Select POIs"));
                        $('#ddlEndLocationPOI').append($('<option disabled selected></option>').val("").html("Select POIS"));

                        $.each(result, function (j, item) {
                            $('#ddlStartLocationPOI').append($('<option></option>').val(item.id).html(item.details));
                            $('#ddlEndLocationPOI').append($('<option></option>').val(item.id).html(item.details));
                            $('#ddlMoreLocationsPOI').append($('<option></option>').val(item.id).html(item.details));

                        });
                    }

                },
                error: function () {
                    connectionError();
                }
            });
        }
        function Close() {
            $("#hidedivnewd").css('display', 'none');
        }




        function submitUpdateSettings() {
            var custId = $custid;

            var startLocation = $("#ddlStartLocationPOI").val();
            var endLocation = $("#ddlEndLocationPOI").val();
            var morePoiIds = $("#ddlMoreLocationsPOI").val();
            var morePoiIdsList = morePoiIds.toString();

            var triptypeID = $("#triptype").val();


            var routeName = $("#txtRouteName").val();
            var ettTime = $("#txtETT").val();


            var bbidArray = $("#ddlVehicleList").val();
            var bbidList = bbidArray.toString();



            var distanceKm;
            distanceKm = $("#txtManualDistance").val();

            //getting datetime
            var startDateTime = $beginDate;
            var endDateTime = $endDate;


            if (!startLocation || !endLocation || !routeName) {
                $("#valStartLocation").removeClass("hidden");
                $("#valEndLocation").removeClass("hidden");
                $("#valRouteName").removeClass("hidden");


                return false;
            }
            else {
                $("#valStartLocation").addClass("hidden");
                $("#valEndLocation").addClass("hidden");
                $("#valvehicleslist").addClass("hidden");
                $("#valRouteName").addClass("hidden");
            }





            swal({
                title: "Do you want to create Route as Trip?",
                text: "",
                type: "warning",
                showCancelButton: true,
                confirmButtonClass: "btn-danger",
                confirmButtonText: "Yes!",
                cancelButtonText: "No!",
                closeOnConfirm: false,
                closeOnCancel: false
            },
function (isConfirm) {
    var Routetype = 0;
    if (isConfirm) {
        swal("Created!", "Your Route saved successfully as Trip Also.", "success");

        Routetype = 3;
    } else {
        swal("Created!", "Your have saved Route successfully.", "success");
        Routetype = 1;
    }
    $.blockUI({ message: '<div style=" width: 450px !important; border: none !important; border-radius: 21px !important;background: rgba(192,192,192,0.9);position: absolute !important; box-shadow: 7px 7px 5px 0px rgba(192,192,192,0.9) !important;background: -moz-linear-gradient(30deg, rgba(192,192,192,0.9) 30%, rgba(192,192,192,0.9) 70%) !important; background: -webkit-linear-gradient(30deg, rgba(192,192,192,0.9) 30%, rgba(192,192,192,0.9) 70%) !important; background: -o-linear-gradient(30deg, rgba(192,192,192,0.9) 30%, rgba(192,192,192,0.9) 70%) !important;background: -ms-linear-gradient(30deg, rgba(192,192,192,0.9) 30%, rgba(192,192,192,0.9) 70%) !important;background: linear-gradient(120deg, rgba(192,192,192,0.9) 30%, rgba(192,192,192,0.9) 70%) !important;font-size:  14px !important;font-weight: normal !important; height:0;">   <img src="../../Content/Trackmaster_files/loader.gif"  style="height:360px;"/> </div>' });

    var baseurl = apiBase.apiurl;
    var url = baseurl + "adminapi/UpdateTripSettings";
    $.ajax({
        url: url,
        dataType: "json",
        type: "GET",
        contentType: 'application/x-www-form-urlencoded; charset=utf-8',
        data: { SLocation: startLocation, ELocation: endLocation, custId: custId, distance: distanceKm, triptypeID: triptypeID, routeName: routeName, ettTime: ettTime, bbidList: bbidList, poiIds: morePoiIdsList, startDateTime: startDateTime, endDateTime: endDateTime, Routetype: Routetype },

        success: function (data) {
            $.unblockUI();
            toastr.success('The has been Route Created successfully!');

        },
        error: function (err) {
            $.unblockUI();
            toastr.warning('something went wrong!');
        }

    });
});

            return false;
        }


    </script>
    <!--for ADDING POI DIRECTLY-->
    <script type="text/javascript" src="~/js/common.js"></script>



<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBu4NyT_yiDqc-z09IviAzDSZDxPi2LTgg&libraries=drawing,places" language="javascript" type="text/javascript"></script>

<script src="~/Content/Multiselect/tagsinput.js"></script>
<script type="text/javascript" src="//code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<script src="~/Content/Multiselect/jquery.autocomplete.multiselect.js"></script>
    <script>
        var url = apiBase.apiurl + "Commonapi/Getroutelist";
        $('#txtRouteName').autocomplete({

            source: function (request, response) {
                var query = extractLast(request.term);
                $.ajax({
                    dataType: "json",
                    type: "GET",
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    url: url,
                    data: { query: query, custid: $custid },
                    async: false,
                    success: function (data) {

                        response($.map(data, function (item) {

                            return {
                                label: item.Routename,
                                value: item.Id
                            }
                        })
                        );
                    }
                })
            },

            focus: function () {
                return false;
            },
            select: function (event, ui) {


              
                var lab = ui.item.label;
             
                setpoivalue(ui.item.value);
                $("#txtRouteName").val(lab);
              
                return false;

            },
            minLength: 2,
        });


        function setpoivalue(routeid) {



            var url = apiBase.apiurl + "Commonapi/Getroutedetailedlist";

            $.ajax({
                dataType: "json",
                type: "GET",
                contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                url: url,
                data: { routeid: routeid },
                async: false,
                success: function (data) {

                    debugger;
                    var poiId = data[0].SLId + ',' + data[0].PoiIds + ',' + data[0].ELId;

                    $.ajax({
                        url: apiBase.apiurl + 'CommonApi/GetPOI?custid=' + $custid,
                        type: "get",
                        async: false,
                        success: function (datares) {
                            var result = datares;
                            if (result.length > 0) {
                               

                                $.each(result, function (j, item) {

                                    if (data[0].SLId == item.id)
                                    {
                                        $('#ddlStartLocationPOI').append($('<option selected></option>').val(item.id).html(item.details));
                                    }

                                    if (data[0].ELId == item.id) {
                                        $('#ddlEndLocationPOI').append($('<option selected></option>').val(item.id).html(item.details));
                                    }
                                 

                                    var str = data[0].PoiIds.split(",");
                                    $.each(str, function (index, value) {
                                       
                                        if (value == item.id) {
                                            $('#ddlMoreLocationsPOI').append($('<option selected></option>').val(item.id).html(item.details));
                                        }
                                    });


                                   

                                });
                            }

                        },
                        error: function () {
                            connectionError();
                        }
                    });


                    var poiIdsList = poiId.toString();

                    morePointsFun(poiIdsList);
                }
            })

        };

        function split(val) {
            return val.split(/,\s*/);
        }

        function extractLast(term) {
            return split(term).pop();
        }
    </script>
    <script type="text/javascript">
        $(document).ready(function () {

            geocoder = new google.maps.Geocoder();
            var lat = GET('lat');
            var lng = GET('longi');
            if (lat == "") {
                lat = '30.724149';
                lng = '76.76';
            }
            var myLatlng = new google.maps.LatLng(parseFloat(lat), parseFloat(lng));
            var myOptions = {
                zoom: 14,
                center: myLatlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            }
            map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

            var pinImage = new google.maps.MarkerImage("/Content/img/POI/Dflts.png");
            marker = new google.maps.Marker({
                position: myLatlng,
                icon: pinImage,
                map: map,
                title: "Add location",
                draggable: true

            });
            //for clearing when user search by place
            markersCodeAddress.push(marker);

            // info window
            infowindow = new google.maps.InfoWindow({
                content: html
            });
            google.maps.event.addListener(marker, "click", function () {
                infowindow.open(map, marker);
            });
        });
      
        var html = "<table class='table' cellpadding='5' cellspacing='5' style='width:450px;'>" +
           " <tr ><th colspan='2'> Kindly Enter the Location Name and press the save button to save it</th></tr>" +
                 "<tr><td style='font-weight:bold;'>Name POI:</td> <td><input type='text' class='text' style='width:250px;' id='name'/> </td> </tr>" +
                 "<tr><td></td><td><input class='btn btn-green btn-small' type='button' value='Save' onclick='saveData()'/></td></tr><tr ><td colspan='2'><span id='message' style='font-weight:bold;font-size:16px;'></span></td></tr></table>";
        var marker;
        var infowindow;
        var geocoder;


        function saveData() {
            var startLocation = $("#ddlStartLocationPOI").val();
            var endLocation = $("#ddlEndLocationPOI").val();
            var morePoiIds = $("#ddlMoreLocationsPOI").val();

            var message = "";
            var lat = GET('lat');
            var lng = GET('longi');
            var name = decodeURIComponent(document.getElementById("name").value);
            if (name == '') {

                alert('Please enter location');
                return false;
            }
            else {
                var latlng = marker.getPosition();
                lat = latlng.lat();
                lng = latlng.lng();
                var MyUrl = apiBase.apiurl + "CommonApi/AddPOIntrest";
                $.ajax({

                    url: MyUrl,
                    type: "GET",
                    data: { custid: $custid, lat: lat, longi: lng, location: name },
                    success: function (data) {


                        if (data == "Location Exists") {
                            message = "Location Already Exist!";
                            $("#message").html("Location Already Exist!");
                            $("#message").css("color", "red");
                        }
                        else {
                            if (data == false) {
                                message = "Your POI limit is over. If you want to add new POIs than please contact Our Market Executives.";
                                $("#message").html("Your POI limit is over. If you want to add new POIs than please contact Our Market Executives.");
                                $("#message").css("color", "red");
                            }
                            else {
                            }
                            message = "Location Saved Succesfully,Kindly check in the Dropdownlist to use it!";
                            $("#message").html("Location Saved Succesfully,Kindly check in the POI List !");

                            document.getElementById("message").style.color = "green";                        
                            $("#name").val("");
                            updateroute(startLocation, endLocation, morePoiIds);
                            alert(message);
                        }

                       
                      
                    }
                });
            }


        }


        function updateroute(startLocation, endLocation, morePoiIds)
        {
            debugger;


        
            $.ajax({
                url: apiBase.apiurl + 'CommonApi/GetPOI?custid=' + $custid,
                type: "get",
                async: false,
                success: function (data) {
                    var result = data;
                    if (result.length > 0) {
                        $('#ddlStartLocationPOI').append($('<option disabled selected></option>').val("").html("Select POIs"));
                        $('#ddlEndLocationPOI').append($('<option disabled selected></option>').val("").html("Select POIS"));

                        $.each(result, function (j, item) {
                            if (startLocation == item.id)
                            {
                                $('#ddlStartLocationPOI').append($('<option selected></option>').val(item.id).html(item.details));
                            }
                            else
                            {
                                $('#ddlStartLocationPOI').append($('<option ></option>').val(item.id).html(item.details));

                            }


                            if (endLocation == item.id) {
                                $('#ddlEndLocationPOI').append($('<option selected></option>').val(item.id).html(item.details));
                            }
                            else {
                                $('#ddlEndLocationPOI').append($('<option ></option>').val(item.id).html(item.details));

                            }


                            var str = morePoiIds.toString().split(",");
                            $.each(str, function (index, value) {

                                if (value == item.id) {
                                    $('#ddlMoreLocationsPOI').append($('<option selected></option>').val(item.id).html(item.details));
                                }
                                else
                                {
                                    $('#ddlMoreLocationsPOI').append($('<option ></option>').val(item.id).html(item.details));

                                }
                            });

                           

                        });
                    }

                },
                error: function () {
                    connectionError();
                }
            });
        }

        function doNothing() { }

        $("#btnaddroute").click(function () {
            window.location.href = "@Url.Action("ManageRoute", "settings","_blank")";

        });



    </script>
    <script>

        var endLocationLat;
        var endLocationLong;

        google.maps.event.addDomListener(window, 'load', initialize1);
        google.maps.event.addDomListener(window, 'load', initialize2);
        google.maps.event.addDomListener(window, 'load', initialize3);
        function initialize1() {
         
            var input = document.getElementById('addressPlace');
            var options = {
                componentRestrictions: { country: 'IN' }
            };
            var autocomplete = new google.maps.places.Autocomplete(input, options);
            autocomplete.addListener('place_changed', function () {

                var place = autocomplete.getPlace();
                // place variable will have all the information you are looking for.
                console.log(place.geometry['location'].lat());
                endLocationLat = place.geometry['location'].lat();
                endLocationLong = place.geometry['location'].lng();

                console.log(place.geometry['location'].lng());
                codeAddress();
            });
        }


        function initialize2() {

            var input = document.getElementById('addressPlace1');
            var options = {
                componentRestrictions: { country: 'IN' }
            };
            var autocomplete = new google.maps.places.Autocomplete(input, options);
            autocomplete.addListener('place_changed', function () {

                var place = autocomplete.getPlace();
                // place variable will have all the information you are looking for.
                console.log(place.geometry['location'].lat());
                endLocationLat = place.geometry['location'].lat();
                endLocationLong = place.geometry['location'].lng();

                console.log(place.geometry['location'].lng());
                codeAddress1();
            });
        }
        function initialize3() {

            var input = document.getElementById('addressPlace2');
            var options = {
                componentRestrictions: { country: 'IN' }
            };
            var autocomplete = new google.maps.places.Autocomplete(input, options);
            autocomplete.addListener('place_changed', function () {

                var place = autocomplete.getPlace();
                // place variable will have all the information you are looking for.
                console.log(place.geometry['location'].lat());
                endLocationLat = place.geometry['location'].lat();
                endLocationLong = place.geometry['location'].lng();

                console.log(place.geometry['location'].lng());
                codeAddress2();
            });
        }

        var markersCodeAddress = [];

        function codeAddress() {

            var address = document.getElementById('addressPlace').value;
            geocoder.geocode({ 'address': address }, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    map.setCenter(results[0].geometry.location);
                    $('#LatLng').val(results[0].geometry.location);
                    var pinImage = new google.maps.MarkerImage("/Trackmaster_files/Fuel/marker.png");
                    clearLocations();
                    marker = new google.maps.Marker({
                        // map: map,
                        position: results[0].geometry.location,
                        icon: pinImage,
                        map: map,
                        title: "Add location",
                        draggable: true
                    });
                    markersCodeAddress.push(marker);

                    // info window
                    infowindow = new google.maps.InfoWindow({
                        content: html
                    });
                    google.maps.event.addListener(marker, "click", function () {
                        infowindow.open(map, marker);
                    });
                    infowindow.open(map, marker);
                    google.maps.event.addDomListener(window, 'load', initialize);
                } else {
                    alert('Geocode was not successful for the following reason: ' + status);
                }
            });



        }
        function codeAddress1() {

            var address = document.getElementById('addressPlace1').value;
            geocoder.geocode({ 'address': address }, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    map.setCenter(results[0].geometry.location);
                    $('#LatLng').val(results[0].geometry.location);
                    var pinImage = new google.maps.MarkerImage("/Trackmaster_files/Fuel/marker.png");
                    clearLocations();
                    marker = new google.maps.Marker({
                        // map: map,
                        position: results[0].geometry.location,
                        icon: pinImage,
                        map: map,
                        title: "Add location",
                        draggable: true
                    });
                    markersCodeAddress.push(marker);

                    // info window
                    infowindow = new google.maps.InfoWindow({
                        content: html
                    });
                    google.maps.event.addListener(marker, "click", function () {
                        infowindow.open(map, marker);
                    });

                    infowindow.open(map, marker);
                    google.maps.event.addDomListener(window, 'load', initialize);
                } else {
                    alert('Geocode was not successful for the following reason: ' + status);
                }
            });



        }
        function codeAddress2() {

            var address = document.getElementById('addressPlace2').value;
            geocoder.geocode({ 'address': address }, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    map.setCenter(results[0].geometry.location);
                    $('#LatLng').val(results[0].geometry.location);
                    var pinImage = new google.maps.MarkerImage("/Trackmaster_files/Fuel/marker.png");
                    clearLocations();
                    marker = new google.maps.Marker({
                        // map: map,
                        position: results[0].geometry.location,
                        icon: pinImage,
                        map: map,
                        title: "Add location",
                        draggable: true
                    });
                    markersCodeAddress.push(marker);

                    // info window
                    infowindow = new google.maps.InfoWindow({
                        content: html
                    });
                    google.maps.event.addListener(marker, "click", function () {
                        infowindow.open(map, marker);
                    });
                    infowindow.open(map, marker);
                    google.maps.event.addDomListener(window, 'load', initialize);
                } else {
                    alert('Geocode was not successful for the following reason: ' + status);
                }
            });



        }
        function clearLocations() {
            for (var i = 0; i < markersCodeAddress.length; i++) {
                markersCodeAddress[i].setMap(null);
            }
            markersCodeAddress.length = 0;
        }
    </script>
    <!--END-->
    <script type="text/javascript">
        //<![CDATA[
        var map = null;
        var service;
        var markerroute;
        var markerroutearry=[];
        var renderer;
        var directionDisplay;
        var directionsService = new google.maps.DirectionsService();
        var j = 0;

        function initialize() {

            directionsDisplay = new google.maps.DirectionsRenderer(
                {
                    draggable: true

                });
            var mapOptions = {
                litemode: true,
                zoom: 14, //zoom level highest is 21 if m not wrong,
                mapTypeId: google.maps.MapTypeId.ROADMAP, //view type of the google map, ie either satellite, or road maps
                center: new google.maps.LatLng(30.850033, 76.6500523), //the longitute and latitude of the place which you want to put center in the map
            };
            map = new google.maps.Map(document.getElementById('map_canvas'), // defining div id to get the map
    mapOptions);


            directionsDisplay.setMap(map);

            directionsDisplay.addListener('directions_changed', function () {
                //  computeTotalDistance(directionsDisplay.getDirections());
            });

        }


        google.maps.event.addDomListener(window, "load", initialize);
        j = 1;
    </script>
    <script>
        var startLoc; var endLoc; var morePoints = [];

        var allpoi;
        var poiIdtesting = 0;
        var poilegth = 0;
        $("#ddlStartLocationPOI").change(function () {

            debugger;
          
            $('#chkdisable').prop('checked', false);

            var poiId = $('option:selected', this).val();

            //$.ajax({
            //    dataType: "json",
            //    type: "GET",
            //    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
            //    url: apiBase.apiurl + "CommonAPI/GetVehiclewithInRadius",

            //    data: { Custid: $custid, poiid: poiId,Distance:$("#Kilo").val() },
            //    success: function (result) {

            //        var data = result;

            //        if (data.length > 0) {
                       
            //            $('#ddlVehicleList').empty();
                    
            //            $('#ddlVehicleList').append($('<option></option>').val(0).html("All Vehicles"));
            //            $.each(data, function (j, item) {
                           
            //                $('#ddlVehicleList').append($('<option></option>').val(item.bbid).html(item.vehicleName));                          
            //                $('#movingtag').html(item.M);
            //                $('#parkedtag').html(item.P);
            //                $('#Ignitiontag').html(item.I);
            //                $('#Hispeedtag').html(item.H);
            //                $('#Unreachtag').html(item.U);

            //            });
            //            //$('#ddlVehicleList').trigger("chosen:updated");
                       
            //        }

            //    }
            //});


          
            startLoc = commonForStartEndPOI(poiId);


            allpoi = poiId;
          
            morePointsFun(poiId);

        });

        $('#chkdisable').click(function () {           
            var thisCheck = $(this);
            if (thisCheck.is(':checked')) {               
                $('#ddlVehicleList').empty();

                $.ajax({
                    dataType: "json",
                    type: "GET",
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    url: apiBase.apiurl + "AdminAPI/GetVehicles",

                    data: { custId: $custid },
                    success: function (result) {

                        var data = result;

                        if (data.length > 0) {
                            $('#ddlVehicleList').append($('<option></option>').val(0).html("All Vehicle's"));
                            $.each(data, function (j, item) {
                                $('#ddlVehicleList').append($('<option></option>').val(item.Value).html(item.Text));

                            });
                        }

                    }
                });
            }
        });

        $("#ddlEndLocationPOI").change(function () {

           

            $("#hidedivnew").css('display', 'block');


            var poiIdone = $("#ddlStartLocationPOI").val();

            var poiId = $('option:selected', this).val();

            poiId = poiIdone + ',' + poiId;
            endLoc = commonForStartEndPOI(poiId);
            if (!startLoc) {
                toastr.warning("Please select start location poi");
                return false;
            }
            allpoi = poiId;
            

            morePointsFun(poiId);
        });

        $("#ddlMoreLocationsPOI").change(function () {
          
            var poiId = 0;
            if (poiIdtesting.length > 0) {

                var pois = $("#ddlMoreLocationsPOI").val();


                if (pois.length > poiIdtesting.length)
                {
                    var myarray = pois.toString().split(',')

                    for (var x = 0; x < myarray.length; x++) {
                        var text = myarray[x];
                        var n = poiIdtesting.includes(text);

                        if (n== false)
                        {
                            poiIdtesting = poiIdtesting + ',' + text;
                        }
                    }
                }
                else
                {
                    var myarray = poiIdtesting.toString().split(',')

                    for (var x = 0; x < myarray.length; x++) {
                        var text = myarray[x];
                        var n = pois.includes(text);

                        if (n == false) {
                            poiIdtesting = poiIdtesting.toString().replace(text, '');
                        }
                    }

                }
                poiId = poiIdtesting;
            }
            else
            {
                poiId = $("#ddlMoreLocationsPOI").val();
            }

            poiIdtesting = $("#ddlMoreLocationsPOI").val();


            var poiend = $("#ddlEndLocationPOI").val();
            var poistard = $("#ddlStartLocationPOI").val();

            poiId = poistard + ',' + poiId + ',' + poiend;

            var poiIdsList = poiId.toString();
            allpoi = poiIdsList;
         

            morePointsFun(poiIdsList);
            if (!startLoc || !endLoc) {
                toastr.warning("Please select start and end location poi");
                return false;
            }
            // getDirections();
        });

        function commonForStartEndPOI(poiId) {
            var location;
            $.ajax({
                dataType: "json",
                type: "GET",
                contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                url: apiBase.apiurl + "MapAPI/GetPoiLatLongForAddTrip",
                data: { poiId: poiId },
                async: false,
                success: function (data) {
                    for (i = 0; i < data.length; i++) {
                        location = data[0].lat + ',' + data[0].lng;

                    }

                },
                error: function () {
                    alert('Please try again');
                }
            })
            return location;
        }

        function morePointsFun(poiIds) {

           

            
            if (renderer != null) {

                initialize();
                //setMapOnAll(null);
                //renderer.setMap(null);
                //renderer = null;

                //markerroutearry.setMap(null);
                //markerroutearry = null;
            }
            clearLocations();
             service = new google.maps.DirectionsService;
        //    var map = new google.maps.Map(document.getElementById('map_canvas'));
            var stations = [];
            var myarray = poiIds.split(',');

            for (var x = 0; x < myarray.length; x++) {
                var text = myarray[x];
                
                var location;
                $.ajax({
                    dataType: "json",
                    type: "GET",
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    url: apiBase.apiurl + "MapAPI/GetPoiLatLongForAddTrip",
                    data: { poiId: text },
                    async: false,
                    success: function (data) {

                        for (i = 0; i < data.length; i++) {
                            location = data[i].lat + ',' + data[i].lng;
                            stations.push({
                                lat: parseFloat(data[i].lat),
                                lng: parseFloat(data[i].lng),
                                name: data[i].Name

                            });
                        }

                    }
                })
            }


            var lngs = stations.map(function (station) { return station.lng; });
            var lats = stations.map(function (station) { return station.lat; });
            map.fitBounds({
                west: Math.min.apply(null, lngs),
                east: Math.max.apply(null, lngs),
                north: Math.min.apply(null, lats),
                south: Math.max.apply(null, lats),
            });

            // Show stations on the map as markers
            for (var i = 0; i < stations.length; i++) {
                if (!stations[i].name)
                    continue;
                if (i == 0) {
                    markerroute=    new google.maps.Marker({
                        position: stations[i],
                        map: map,
                        title: stations[i].name,
                        icon: '../Trackmaster_files/Fuel/green.png'
                    });
                    markerroutearry.push(markerroute);


                }
                else if (i == stations.length - 1) {


                    markerroute=   new google.maps.Marker({
                        position: stations[i],
                        map: map,
                        title: stations[i].name,
                        icon: '../Trackmaster_files/Fuel/red.png'
                    });
                    markerroutearry.push(markerroute);
                }
                else {
                    markerroute=    new google.maps.Marker({
                        position: stations[i],
                        map: map,
                        title: stations[i].name,
                        icon: '../Trackmaster_files/Fuel/sky.png'
                    });
                    markerroutearry.push(markerroute);

                }


            }

            // Divide route to several parts because max stations limit is 25 (23 waypoints + 1 origin + 1 destination)
            for (var i = 0, parts = [], max = 8 - 1; i < stations.length; i = i + max)
                parts.push(stations.slice(i, i + max + 1));
            var totalDistance = 0;
            var totalTime = 0;

            // Callback function to process service results
            var service_callback = function (response, status) {
                if (status != 'OK') {
                    console.log('Directions request failed due to ' + status);
                    return;
                }
                 renderer = new google.maps.DirectionsRenderer;
                renderer.setMap(map);
                renderer.setOptions({ suppressMarkers: true, preserveViewport: true });
                renderer.setDirections(response);
                var route = response.routes[0];
                var summaryPanel = document.getElementById('directions-panel');
                var distanceValue = document.getElementById('txtManualDistance');
                var ettValue = document.getElementById('txtETT');


                summaryPanel.innerHTML = '';
                // For each route, display summary information.
                for (var i = 0; i < route.legs.length; i++) {                  
                    var routeSegment = i + 1;
                    summaryPanel.style.display = "block";
                    summaryPanel.innerHTML += '<b>' + routeSegment +
                        '</b><br>';
                    summaryPanel.innerHTML += route.legs[i].start_address + ' to ';
                    summaryPanel.innerHTML += route.legs[i].end_address + '<br>';
                    summaryPanel.innerHTML += route.legs[i].distance.text + '<br><br>';

                    //getting total distance
                    totalDistance = totalDistance + parseFloat((route.legs[i].distance.value / 1000).toFixed(0));
                    //getting total estimated time
                    totalTime = totalTime + parseFloat((route.legs[i].duration.value / parseInt(60)).toFixed(0));


                }
                distanceValue.value = totalDistance;
                $("#test1").html(totalTime + "minutes");
                ettValue.value = totalTime;
            };

            // Send requests to service to get route (for stations count <= 25 only one request will be sent)
            for (var i = 0; i < parts.length; i++) {
                // Waypoints does not include first station (origin) and last station (destination)
                var waypoints = [];
                for (var j = 1; j < parts[i].length - 1; j++)
                    waypoints.push({ location: parts[i][j], stopover: false });
                // Service options
                var service_options = {
                    origin: parts[i][0],
                    destination: parts[i][parts[i].length - 1],
                    waypoints: waypoints,
                    travelMode: google.maps.TravelMode.DRIVING
                };



                // Send request
                service.route(service_options, service_callback);
            }


        }



        function computeTotalDistance(result) {
            var total = 0;
            var duration = 0;
            var myroute = result.routes[0];
            for (var i = 0; i < myroute.legs.length; i++) {
                total += myroute.legs[i].distance.value;

            }
            total = total / 1000;


            document.getElementById('txtManualDistance').innerHTML = total + ' km';
        }
    </script>
    
    <script>
        var circle = null;
        var markers = [];
        var searchLatLng;
        function AjaxGetVehicleNearestToPoint() {

            //thi is used to clear markers
            deleteMarkers();
          
            var Radius = parseInt((1000));


            var mySplitResult = startLoc.split(",");

            var lat = mySplitResult[0].toLowerCase().replace(/[\,\(\)\!\$]/g, '');
            var lng = mySplitResult[1].toLowerCase().replace(/[\,\(\)\!\$]/g, '');


            var myLatlng = new google.maps.LatLng(lat, lng);
            searchLatLng = myLatlng;
            map.setCenter(myLatlng);
            var infowindow = new google.maps.InfoWindow()

            var marker = new google.maps.Marker({
                map: map,
                position: myLatlng

            });
           
        }

        // Removes the markers from the map, but keeps them in the array.
        function clearMarkers() {
            setMapOnAll(null);
        }

        // Deletes all markers in the array by removing references to them.
        function deleteMarkers() {
            clearMarkers();
            markers = [];
        }

        //plot marker
        function plotMarker(position, map, name, Location, currentdate, VehStatus, bbid, IsDispatched, lat, lng, icon) {

            VehStatus = VehStatus.replace("~/", "../../");
            poiMarker = new google.maps.Marker({

                position: position,
                map: map,
                draggable: false,
                clickable: true,
                icon: VehStatus,
                animation: google.maps.Animation.DROP
            });
            var poimarker1 = poiMarker;
            markers.push(poiMarker);

            var contentString = '<b>Vehicle Name:</b>' + name + '<br/><b>Location:</b>' + Location + '<br/>' + '<b>Date: </b>' + currentdate + status;
            var infowindow = new google.maps.InfoWindow({
                content: contentString
            });
            google.maps.event.addDomListener(poimarker1, 'click', function () {
                infowindow.open(map, poimarker1);
            });
        }

        // Sets the map on all markers in the array.
        function setMapOnAll(map) {
            for (var i = 0; i < markers.length; i++) {
                markers[i].setMap(map);
            }
        }

    </script>

    <style>
        #slide {
            height: 50px;
            transition: height 500ms ease;
            -moz-transition: height 500ms ease;
            -ms-transition: height 500ms ease;
            -o-transition: height 500ms ease;
            -webkit-transition: height 500ms ease;
        }

        .primary-button {
            font-family: Arial, sans-serif;
            font-size: 1.3em;
            color: #fff;
            border: 1px solid #004487;
            background-image: -webkit-gradient(linear, top, bottom, from(#5288bd), to(#2f659a));
            background-image: -webkit-linear-gradient(top, #5288bd, #2f659a);
            box-shadow: inset 0px 1px 0px rgba(255, 255, 255, 0.4), inset 0px 0px 0px 1px rgba(255, 255, 255, 0.2), 0px 1px 0px rgba(255, 255, 255, .7);
            transform: rotate(90deg);
            text-shadow: 0px -1px 0px black;
            cursor: pointer;
            margin-top: 170px;
        }

        .download-button {
            padding: 4px 20px;
            border-radius: 5px;
            display: block;
            width: 130px;
            margin: 32px auto -25px auto;
            margin-left: 345px;
        }
    </style>
    <script>
        $("#imgclose").click(function () {
            //$("#hidedivnew").css('display', 'none');
            $("#hidedivnew").slideToggle();
            $("#btntrip").css('display', 'block');
            $("#btntripN").css('display', 'block');
        });


        $("#btntrip").click(function () {
            $("#hidedivnew").css('display', 'block');
            $("#btntrip").css('display', 'none');

        });



        $("#btnaddpoi").click(function () {
            $("#hidedivnewd").css('display', 'block');


        });

        $("#btntripN").click(function () {
            $("#hidedivnew").css('display', 'block');

            $("#btntripN").css('display', 'none');
        });
    </script>

}